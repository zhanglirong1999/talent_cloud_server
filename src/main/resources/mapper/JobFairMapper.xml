<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="seu.talents.cloud.talent.model.dao.mapper.JobFairMapper">
    <select id="getAll" resultType="seu.talents.cloud.talent.model.dao.entity.JobFair">
        SELECT jobFairName, detailLink, city, address, type, CONCAT(CONCAT(DATE_FORMAT(startTime, '%Y-%m-%d %H:%i'), ' - '), DATE_FORMAT(endTime, '%Y-%m-%d %H:%i')) AS time
        FROM job_fair
        WHERE deleted = 0;
    </select>

    <select id="searchJobFair" resultType="seu.talents.cloud.talent.model.dao.entity.JobFair">
        SELECT jobFairName, detailLink, city, address, type, CONCAT(CONCAT(DATE_FORMAT(startTime, '%Y-%m-%d %H:%i'), ' - '), DATE_FORMAT(endTime, '%Y-%m-%d %H:%i')) AS time
        FROM job_fair
        WHERE deleted = 0
        <if test="keyWord != null">
            AND (
            jobFairName LIKE CONCAT(CONCAT('%', #{keyWord}), '%')
            )
        </if>
        <if test="range != null">
            AND publishRange = #{range}
        </if>
        <if test="type != null">
            AND type = #{type}
        </if>
        <if test="city != null">
            AND city LIKE CONCAT(CONCAT('%', #{city}), '%')
        </if>
        <if test="time != null">
            <if test='time == "近一周"'>
                AND DATE_ADD(CURDATE(), INTERVAL 7 DAY) &gt;= DATE(startTime) AND DATE(startTime) &gt;= CURDATE()
            </if>
            <if test='time == "近一个月"'>
                AND DATE_SUB(CURDATE(), INTERVAL 23 DAY) &lt;= DATE(startTime) AND DATE(startTime) &lt;= DATE_ADD(CURDATE(), INTERVAL 7 DAY)
            </if>
            <if test='time == "近一年"'>
                AND DATE_SUB(CURDATE(), INTERVAL 358 DAY) &lt;= DATE(startTime) AND DATE() &lt;= DATE_ADD(CURDATE(), INTERVAL 7 DAY)
            </if>
        </if>
    </select>

</mapper>